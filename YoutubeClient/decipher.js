function applyActions(r,e){for(var n,t={slice:function(r,e){r.slice(e)},splice:function(r,e){r.splice(0,e)},reverse:function(r){r.reverse()},swap:function(r,e){var n=r[0];r[0]=r[e%r.length],r[e]=n}},a=e.split(""),i=0;n=r[i];i++)t[n[0]](a,n[1]);return a.join("")}function readObfFunc(r,e){var n=r.match(/\[(\w+)\]/g);if(n){for(var t,a=0;t=n[a];a++){var i=e.match(new RegExp("[, ]{1}"+t.slice(1,-1)+'="(\\w+)"'));i&&(r=r.replace(t,"."+i[1]))}for(var s,c=r.split(";"),o=[],a=0;s=c[a];a++)if(-1===s.indexOf(".split(")&&-1===s.indexOf(".join("))if(-1===s.indexOf("reverse")){var f=s.match(/splice\((\d+)\)/);if(f){if(f=parseInt(f[1]),isNaN(f))return;o.push(["splice",f])}else{var f=s.match(/slice\((\d+)\)/);if(f){if(f=parseInt(f[1]),isNaN(f))return;o.push(["slice",f])}else{var f=s.match(/\[(\d+)%\w+\.length/);if(f){if(f=parseInt(f[1]),isNaN(f))return;o.push(["swap",f])}}}}else o.push(["reverse",null]);return o}}function getNewActList(r){var e=function(e,n){e=e.replace(/\$/g,"\\$");var t=new RegExp("(?:var |,)?"+e+"={"),a=r.search(t);if(-1===a)throw new Error("Place is not found");var i=r.substr(a,300);n=n.replace(/\$/g,"\\$");var s=new RegExp(n+":function\\(([$\\w,]+)\\){([^}]+)}"),c=i.match(s);if(!c)throw new Error("Place function is not found!");var o=c[1],f=c[2];return{args:o,statement:f}},n=function(r){var n=/([\w$]+)(?:\.([\w$]+)|\[("[\w$]+")\])\([\w$]+,?([\w$]+)?\)/.exec(r);if(!n)throw new Error("readAction");var t=n[1],a=n[2]||n[3],i=n[4],s=e(t,a);if(/\.reverse/.test(s.statement))return["reverse",null];if(!/^[\d]+$/.test(i))throw new Error("Arg is not number");return/\.splice/.test(s.statement)?["splice",parseInt(i)]:/\.slice/.test(s.statement)?["slice",parseInt(i)]:["swap",parseInt(i)]},t=function(r,e){r=r.replace(/\$/g,"\\$");var t=new RegExp('[\\w$]+(?:\\.[\\w$]+|\\["[\\w$]+"\\])\\('+r+"[^)]*\\)","g"),a=e.match(t);if(!a)throw new Error("readScope");return a.map(function(r){return n(r)})},a=function(e){e=e.replace(/\$/g,"\\$");var n=new RegExp("(?:function "+e+"|(?:var |,|;\n)"+e+"=function)\\(([\\w$]+)\\){([^}]*)}[;,]"),a=n.exec(r);if(!a)throw new Error("findConvertFn");var i=a[1],s=a[2];return t(i,s)},i=/,sts:(\d+)/.exec(r);if(!i)throw new Error("Sts is not found");var s=(parseInt(i[1]),/[$_a-zA-Z0-9]+\.set\("signature",([$_a-zA-Z0-9]+)\(/.exec(r));if(s||(s=/(?:function ([$_a-zA-Z0-9]+)|(?:var |,|;\n)([$_a-zA-Z0-9]+)=function)\(([\w$]+)\){\3=\3\.split\([^}]+;return \3\.join\([^}]+}[;,]/.exec(r),s&&(s=[s[0],s[1]||s[2]])),!s)throw new Error("Decode function name is not found!");var c=a(s[1]);if(!c.length)throw new Error("actionList is empty");return c}function getActList(r){var e=r.match(/,sts:(\d+)/);e=e&&e[1];var n=[],t=r.match(/\.sig\|\|([$_a-zA-Z0-9]+)\(/);if(!t)return getNewActList(r);t=t[1],t=t.replace(/\$/g,"\\$");var a=r.match(new RegExp("((?:function "+t+"|(?:var |,|;\n)"+t+"=function)\\(([\\w$]+)\\){[^}]*})[;,]"));if(!a)throw new Error("Func is not found!");var i=a[2];a=a[1];var s=new RegExp("[\\w$]+\\.[\\w$]+\\("+i+"[^)]*\\)","g"),c=a.match(s);if(!c){if(n=readObfFunc(a,r),n&&n.length>0)return n;throw new Error("readObfFunc actions is not found")}for(var o,f="",w=[],u=0;o=c[u];u++){var p=o.match(/([\w$]+)\.([\w$]+)\([\w$]+,?([\w$]+)?\)/);p&&(f=p[1],w.push({name:p[2],arg:parseInt(p[3])}))}var l=r.indexOf("var "+f+"={");-1===l&&(l=r.indexOf(","+f+"={")),-1===l&&(l=r.indexOf(f+"={"));var v=r.substr(l,300);for(u=0,o;o=w[u];u++){var i=o.name;s=new RegExp(i+":(function\\([$\\w,]+\\){[^}]+})");var h=v.match(s);if(!h)throw new Error("Match fn error");if(h=h[1],-1!==h.indexOf("splice")){if(isNaN(o.arg))throw new Error("Match splice error");n.push(["splice",o.arg])}else if(-1!==h.indexOf("slice")){if(isNaN(o.arg))throw new Error("Match slice error");n.push(["slice",o.arg])}else if(-1!==h.indexOf("reverse"))o.arg=null,n.push(["reverse",o.arg]);else{if(isNaN(o.arg))throw new Error("Match reverse error");n.push(["swap",o.arg])}}return n}
